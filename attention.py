# -*- coding: utf-8 -*-
"""Attention.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1b-Z84rs54gJjBULZLhUf9mMawJFn_HZ8

# **ATTENTION IS ALL YOU NEED!!**
"""

import numpy as np
import math

#L is the length of the prompt and d_k and d_v are the length of the embedding
L,d_k,d_v=4,8,8
print(L,d_k,d_v)

#we get the q,k,v for every word of the prompt length 4
q=np.random.rand(L,d_k)
k=np.random.rand(L,d_k)
v=np.random.rand(L,d_v)
print("Q is",q)
print()
print("K is",k)
print()
print("V is",v)

"""![selfattne.png](data:image/png;base64,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)


**SELF ATTENTION FORMULA**

Q is compared with every K
using the dot product and higher they can influence each other higher their dot product
this value is scaled and this is multiplied with V so each word value on the basis of the influence from Q*KT is added to the initial V of the word

Q is 4 * 8  
K is 4 *  8

....

....

....

....

....

....

....

....



*

........

........

........

........


Q*KT is
"""

#gives 4*4 this gives the influence of words with each other
#first row is relationship with 1st word with all the words like that
attn=np.matmul(q,k.T)

print(q.var(),
v.var(),
attn.var())
scaled_attn=attn*(1/math.sqrt(d_k))
print(scaled_attn.var())

"""**MASKING THE Scaled_Attn**

As in Decoder like structure the first token should not be affected by the next tokens as that is part of the training to predict the next token issue solve = data leakage.
"""

mask = np.tril(np.ones((L,L)))
mask

mask[mask==0]=-np.inf
mask[mask==1]=0

scaled_attn+=mask
print(scaled_attn)

"""**GETTING THE SOFTMAX DONE**"""

def softmax(x):
  l=np.exp(x)
  y=np.sum(l,axis=-1)
  return l/y

attn_final=softmax(scaled_attn)
print(attn_final)

"""**Getting the new v**

"""

# (4*4) * (4*8)-> 4*8 the first row contains the influence all words should have
# on first word so each v of all words are added first v1 of all words scaled
# using attention becomes v1 of the word then v2 of all words scaled become the
# v2 of first word automatic through multiplication
new_v=np.matmul(attn_final,v)
print(v)
print()
print(new_v)

